@model RegisterModel
@{
    ViewData["Title"] = "Cadastro";
}

@section Styles {
    <link rel="stylesheet" href="~/css/auth.css" asp-append-version="true" />
}

<div class="main-card">
    <h1>Criar uma conta</h1>
    <p>Seja bem-vindo, preencha os dados abaixo para criação da conta</p>
    <div class="create-account-card">
        <form asp-action="Register" method="post">
            @Html.AntiForgeryToken()
            
            <div asp-validation-summary="ModelOnly" class="text-danger"></div>
            
            <div>
                <div class="text-area">
                    <p class="form-label-medium">Nome Completo</p>
                    <input asp-for="Name" class="text-input" />
                    <span asp-validation-for="Name" class="text-danger"></span>
                </div>
                
                <div class="text-area">
                    <p class="form-label-medium">Email</p>
                    <input asp-for="Email" class="text-input" />
                    <span asp-validation-for="Email" class="text-danger"></span>
                </div>

                <div class="input-group mb-2">
                    <p class="form-label-medium">Senha</p>
                    <input asp-for="Password" class="text-input password" type="password" id="passwordField" />
                    <div class="input-group-append">
                        <button type="button" class="btn btn-outline-secondary" onclick="togglePassword()">
                             <img src="~/img/show-password-icon.svg" alt="Show Password" id="toggleIcon" />
                        </button>
                    </div>
                    <span asp-validation-for="Password" class="text-danger"></span>
                </div>

                <div class="text-area">
                    <p class="form-label-medium">Confirmar Senha</p>
                    <input asp-for="ConfirmPassword" class="text-input password" type="password" />
                    <span asp-validation-for="ConfirmPassword" class="text-danger"></span>
                </div>

                <div class="create-account-password-validation-container">
                    <div class="password-requirement" id="lowercase-req">
                        <img src="~/img/validation-icons/info.svg" /> Digite pelo menos 1 caractere minúsculo
                    </div>
                    <div class="password-requirement" id="uppercase-req">
                        <img src="~/img/validation-icons/info.svg" /> Digite pelo menos 1 caractere MAIÚSCULO
                    </div>
                    <div class="password-requirement" id="number-req">
                        <img src="~/img/validation-icons/info.svg" /> Digite pelo menos 1 número
                    </div>
                    <div class="password-requirement" id="length-req">
                        <img src="~/img/validation-icons/info.svg" /> Tenha pelo menos 8 caracteres em sua senha
                    </div>
                </div>
                
                <hr />
                
                <div>
                    <div class="form-check form-check-spaced">
                        <input asp-for="AgreeToTerms" class="form-check-input" type="checkbox" id="termsCheckbox">
                        <label asp-for="AgreeToTerms" class="form-check-label">
                            Eu concordo com os <a href="#">termos de uso</a> e <a href="#">política de privacidade</a>
                        </label>
                        <span asp-validation-for="AgreeToTerms" class="text-danger"></span>
                    </div>
                    
                    <div class="form-check form-check-spaced">
                        <input asp-for="RememberMe" class="form-check-input" type="checkbox">
                        <label asp-for="RememberMe" class="form-check-label">
                            Lembrar meus dados de acesso
                        </label>
                    </div>
                </div>

                <div>
                    <button type="submit" id="registerButton" class="login-button-disabled" disabled>Cadastrar</button>
                </div>
            </div>
        </form>

        <hr/>
        <div>
            <button class="login-google mb-2"><img src="/img/button-icons/google-icon.svg" /> Continue com Google</button>
        </div>
        <div>
            <button class="login-facebook"><img src="/img/button-icons/facebook-icon.svg" /> Continue com Facebook</button>
        </div>
    </div>
</div>


<script>
     
    function togglePassword() {
        var passwordField = document.getElementById("passwordField");
        var toggleIcon = document.getElementById("toggleIcon");

        if (passwordField.type === "password") {
            passwordField.type = "text";
            @* toggleIcon.classList.remove("fa-eye");
            toggleIcon.classList.add("fa-eye-slash"); *@
        } else {
            passwordField.type = "password";
            @* toggleIcon.classList.remove("fa-eye-slash");
            toggleIcon.classList.add("fa-eye"); *@
        }
    }
    document.getElementById('termsCheckbox').addEventListener('change', function () {
        // Get the register button
        var registerButton = document.getElementById('registerButton');

        // Enable the button if the checkbox is checked, otherwise disable it
        registerButton.disabled = !this.checked;
        if (!this.checked) {
            registerButton.className = "login-button-disabled";
        }
        else {
            registerButton.className = "login-button";
        }
    });

    // Password validation functionality
    function validatePassword() {
        var password = document.getElementById('passwordField').value;
        
        // Get all requirement elements
        var lowercaseReq = document.getElementById('lowercase-req');
        var uppercaseReq = document.getElementById('uppercase-req');
        var numberReq = document.getElementById('number-req');
        var lengthReq = document.getElementById('length-req');
        
        // Check each requirement
        var hasLowercase = /[a-z]/.test(password);
        var hasUppercase = /[A-Z]/.test(password);
        var hasNumber = /\d/.test(password);
        var hasMinLength = password.length >= 8;
        
        // Update visual feedback
        updateRequirement(lowercaseReq, hasLowercase);
        updateRequirement(uppercaseReq, hasUppercase);
        updateRequirement(numberReq, hasNumber);
        updateRequirement(lengthReq, hasMinLength);
        
        // Return true if all requirements are met
        return hasLowercase && hasUppercase && hasNumber && hasMinLength;
    }
    
    function updateRequirement(element, isValid) {
        if (isValid) {
            element.classList.remove('invalid');
            element.classList.add('valid');
        } else {
            element.classList.remove('valid');
            element.classList.add('invalid');
        }
    }
    
    // Add event listener to password field
    document.getElementById('passwordField').addEventListener('input', validatePassword);
    document.getElementById('passwordField').addEventListener('keyup', validatePassword);
</script>
